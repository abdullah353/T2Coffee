var SubtestListElementView,_ref,__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a];}}function c(){this.constructor=d;
}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d;};SubtestListElementView=(function(a){__extends(b,a);function b(){_ref=b.__super__.constructor.apply(this,arguments);
return _ref;}b.prototype.tagName="li";b.prototype.className="subtest_element";b.prototype.events={"click .icon_edit":"edit","click .icon_delete":"toggleDeleteConfirm","click .delete_cancel":"toggleDeleteConfirm","click .delete_delete":"delete","click .icon_copy":"openCopyMenu","click .do_copy":"doCopy","click .cancel_copy":"cancelCopy"};
b.prototype.toggleDeleteConfirm=function(){this.$el.find(".delete_confirm").fadeToggle(250);return false;};b.prototype["delete"]=function(){this.trigger("subtest:delete",this.model);
return false;};b.prototype.edit=function(){return Tangerine.router.navigate("subtest/"+this.model.id,true);};b.prototype.initialize=function(c){this.model=c.subtest;
this.group=c.group;return this.$el.attr("data-id",this.model.id);};b.prototype.openCopyMenu=function(){this.$el.find(".copy_menu").removeClass("confirmation");
this.$el.find(".copy_select").append("<option disabled='disabled' selected='selected'>Loading assessments...</option>");return this.fetchAssessments();
};b.prototype.fetchAssessments=function(){var c,d=this;this.groupAssessments=[];c=new Assessments;return c.fetch({success:function(e){d.groupAssessments=e.where({group:d.group});
return d.populateAssessmentSelector();}});};b.prototype.populateAssessmentSelector=function(){var e,f,h,g,d,c;h="";c=this.groupAssessments;for(g=0,d=c.length;
g<d;g++){f=c[g];h+="<option data-assessmentId='"+f.id+"'>"+(f.get("name"))+"</option>";}return e=this.$el.find(".copy_select").html(h);};b.prototype.doCopy=function(c){this.model.copyTo(this.$el.find(".copy_select :selected").attr("data-assessmentId"));
return this.$el.find(".copy_menu").addClass("confirmation");};b.prototype.cancelCopy=function(){return this.$el.find(".copy_menu").addClass("confirmation");
};b.prototype.render=function(){var f,i,h,j,c,d,e,g;g=this.model.get("name");e="<span class='small_grey'>"+(this.model.get("prototype"))+"</span>";c="<img src='images/icon_drag.png' title='Drag to reorder' class='icon sortable_handle'>";
d="<img src='images/icon_edit.png' title='Edit' class='icon icon_edit'>";j="<img src='images/icon_delete.png' title='Delete' class='icon icon_delete'>";
f="<img src='images/icon_copy_to.png' title='Copy to...' class='icon icon_copy'>";i="<div class='confirmation copy_menu'><select class='copy_select'></select><br><button class='do_copy command'>Copy</button> <button class='cancel_copy command'>Cancel</button></div>";
h="<br><span class='delete_confirm'><div class='menu_box'>Confirm <button class='delete_delete command_red'>Delete</button> <button class='delete_cancel command'>Cancel</button></div></span>";
this.$el.html("      <table><tr>      <td>"+c+"</td>      <td>        "+g+"        "+e+"        "+d+"        "+f+"        "+j+"        "+h+"        "+i+"      </td>      </tr></table>    ");
return this.trigger("rendered");};return b;})(Backbone.View);