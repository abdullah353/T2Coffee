var ResultSumView,_ref,__bind=function(a,b){return function(){return a.apply(b,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a];
}}function c(){this.constructor=d;}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d;};ResultSumView=(function(b){__extends(a,b);
function a(){this.afterRender=__bind(this.afterRender,this);_ref=a.__super__.constructor.apply(this,arguments);return _ref;}a.prototype.className="info_box";
a.prototype.events={"click .details":"toggleDetails","click .resume":"resume"};a.prototype.resume=function(){return Tangerine.router.navigate("resume/"+(this.result.get("assessmentId"))+"/"+this.result.id,true);
};a.prototype.toggleDetails=function(){return this.$el.find(".detail_box").toggle(250);};a.prototype.initialize=function(g){var f,h,i,e,c,j,d;this.result=g.model;
this.finishCheck=g.finishCheck;this.finished=((c=_.last(this.result.attributes.subtestData))!=null?c.data.end_time:void 0)!=null?true:false;this.studentId="";
j=this.result.attributes.subtestData;d=[];for(i=0,e=j.length;i<e;i++){h=j[i];f=h.prototype;if(f==="id"){this.studentId=h.data.participant_id;break;}else{d.push(void 0);
}}return d;};a.prototype.render=function(){var m,j,h,g,n,c,k,f,l,e,d;if(this.finished||!this.finishCheck){n=(e=_.last(this.result.attributes.subtestData))!=null?e.data.end_time:void 0;
k=this.result.get("timestamp");if(k!=null){j=new Date(k);}else{if(n!=null){j=new Date(n);}else{j=new Date();}}h="        <div>          "+this.studentId+"          "+(moment(j).format("YYYY-MMM-DD HH:mm"))+"          ("+(moment(j).fromNow())+")          <button class='details command'>details</button>        </div>";
}else{c=new Date(this.result.has("start_time")?this.result.get("start_time"):this.result.get("starttime"));h="<div>Not finished ( "+(moment(c).fromNow())+" ) <button class='command resume'>Resume</button></div>";
}h+="<div class='confirmation detail_box'>";d=this.result.get("subtestData");for(g=f=0,l=d.length;f<l;g=++f){m=d[g];h+="<div><span id='"+this.cid+"_"+g+"'></span>"+m.name+" - items "+m.sum.total+"</div>";
}h+="      </div>    ";this.$el.html(h);return this.trigger("rendered");};a.prototype.afterRender=function(){var e,f,g,h,d,c;c=this.result.get("subtestData");
for(f=h=0,d=c.length;h<d;f=++h){e=c[f];g="#"+this.cid+"_"+f;this.$el.find(g).sparkline([e.sum.correct,e.sum.incorrect,e.sum.missing],{type:"pie",width:"30",height:"30",sliceColors:["#6f6","#c66","#ccc"]});
}return null;};return a;})(Backbone.View);