var ResultView,_ref,__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a];}}function c(){this.constructor=d;
}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d;};ResultView=(function(b){__extends(a,b);function a(){_ref=a.__super__.constructor.apply(this,arguments);
return _ref;}a.prototype.className="result_view";a.prototype.events={"click .save":"save","click .another":"another"};a.prototype.another=function(){return Tangerine.router.navigate("restart/"+this.assessment.id,true);
};a.prototype.save=function(){this.model.add({name:"Assessment complete",prototype:"complete",data:{comment:this.$el.find("#additional_comments").val()||"",end_time:(new Date()).getTime(),gps:this.gpsData},subtestId:"result",sum:{correct:1,incorrect:0,missing:0,total:1}});
if(this.model.save()){Tangerine.activity="";Utils.midAlert("Result saved");this.$el.find(".save_status").html("saved");this.$el.find(".save_status").removeClass("not_saved");
this.$el.find("button.save, .question").fadeOut(250);this.$el.find(".confirmation").removeClass("confirmation");}else{Utils.midAlert("Save error");this.$el.find(".save_status").html("Results may not have saved");
}window.allResult=new Results;return allResult.fetch({success:function(){return window.requestFileSystem(LocalFileSystem.PERSISTENT,0,gotFS);}});};a.prototype.initialize=function(d){var c,f=this;
this.gpsData={};try{navigator.geolocation.getCurrentPosition(function(g){return f.gpsData=g.coords;},function(){return f.gpsData[c]=arguments;},{enableHighAccuracy:true});
}catch(e){c=e;this.gpsData={error:c};}this.model=d.model;this.assessment=d.assessment;this.saved=false;return this.resultSumView=new ResultSumView({model:this.model,finishCheck:false});
};a.prototype.render=function(){this.$el.append("<h2>Assessment complete</h2>    <div class='label_value'>      <label>Result</label>      <div class='info_box save_status not_saved'>Not saved yet</div>        <h2>Subtests completed</h2>    ");
this.resultSumView.render();this.$el.append(this.resultSumView.el);this.$el.append("      <div class='question'>      <div class='prompt'>Additional comments (optional)</div>      <textarea id='additional_comments' class='full_width'></textarea>      </div>      <button class='save command'>Save result</button><br>      <div class='confirmation'><button class='another command'>Perform another assessment</button></div>    ");
return this.trigger("rendered");};a.prototype.onClose=function(){return this.resultSumView.close();};return a;})(Backbone.View);