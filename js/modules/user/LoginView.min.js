var LoginView,_ref,__bind=function(a,b){return function(){return a.apply(b,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a];
}}function c(){this.constructor=d;}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d;};LoginView=(function(b){__extends(a,b);
function a(){this.renderMessages=__bind(this.renderMessages,this);this.render=__bind(this.render,this);_ref=a.__super__.constructor.apply(this,arguments);
return _ref;}a.prototype.className="login_view";a.prototype.events={"click button.login":"login","keypress input":"keyHandler"};a.prototype.initialize=function(c){this.model=Tangerine.user;
this.model.on("change:messages",this.renderMessages);return this.model.on("change:authentication",this.goOn);};a.prototype.goOn=function(){return Tangerine.router.navigate("",true);
};a.prototype.render=function(){var d,c;c=$("#content").width();d=$("#content").offsetParent().width();this.oldWidth=100*c/d;$("#content").css("width","100%");
this.$el.html("      <img src='images/tangerine_logo.png' id='login_logo'>      <div class='messages'></div>      <label for='login_username'>"+(t("enumerator name"))+"</label>      <input id='login_username' name='login_username'>      <label for='login_password'>"+(t("password"))+"</label>      <input id='login_password' name='login_username' type='password'>      <button class='login'>"+(t("login"))+"</button>    ");
return this.trigger("rendered");};a.prototype.onClose=function(){return $("#content").css("width",this.oldWidth+"%");};a.prototype.keyHandler=function(c){if(c.which){if(c.which!==13){return true;
}else{return this.login();}}};a.prototype.login=function(d){var c;c=Utils.getValues(this.el);if(c.login_password===""){this.model.showMessage("Please enter a password");
this.$el.find("#login_password").focus();return false;}return this.model.login(c.login_username,c.login_password);};a.prototype.renderMessages=function(){var d,f,e,g,c;
e=this.model.get("messages")||[];d="<ul>";for(g=0,c=e.length;g<c;g++){f=e[g];d+="<li>"+f+"</li>";}d+="</ul>";return this.$el.find(".messages").html(d);
};return a;})(Backbone.View);